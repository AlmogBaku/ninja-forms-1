FROM calevans/docker:php7.3
RUN apt-get update && apt-get install -y dos2unix
WORKDIR /var/www/html
COPY ./bin/install_gitlab_tests.sh var/www/html/bin/install_gitlab_tests.sh
RUN dos2unix var/www/html/bin/install_gitlab_tests.sh
RUN var/www/html/bin/install_gitlab_tests.sh wordpress_test root mysql latest
RUN cp -r /tmp/wordpress-tests-lib /var/www/html/wordpress-tests-lib
RUN cp -r /tmp/wordpress /var/www/html/wordpress
COPY ./wp-tests-config.php /var/www/html/wordpress-tests-lib/wp-tests-config.php